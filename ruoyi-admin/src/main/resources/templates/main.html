<!DOCTYPE html>
<html  lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--360浏览器优先以webkit内核解析-->
    <title>若依介绍</title>
    <link rel="shortcut icon" href="favicon.ico">
    <link href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
    <link href="../static/css/font-awesome.min.css" th:href="@{/css/font-awesome.min.css}" rel="stylesheet"/>
    <link href="../static/css/main/animate.min.css" th:href="@{/css/main/animate.min.css}" rel="stylesheet"/>
    <link href="../static/css/main/style.min862f.css" th:href="@{/css/main/style.min862f.css}" rel="stylesheet"/>
	<link href="/css/all.css" rel="stylesheet" type="text/css">
	<link href="/css/sb-admin-2.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

	<!-- Custom styles for this template-->

</head>
<style>
	.index_block.index_block_info {
		background: #03a9f4;
	}
	.index_block {
		width: calc((300% + 16px)/4 - 16px);
		height: 100px;
		border-radius: 5px;
		background: #000;
		float: left;
		margin: 27px 16px 0 0;
		color: #fff;
		overflow: hidden;
	}
	.fr{
		font: 17px/1.14 "\5FAE\8F6F\96C5\9ED1","arial";
	}
	.fa{
		display: inline-block;
		font: normal normal normal 14px/1 FontAwesome;
		font-size: 14px;
		font-size: inherit;
		text-rendering: auto;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
	}


</style>

<body class="gray-bg">
<div class="row">

	<!-- Earnings (Monthly) Card Example -->
	<div class="col-xl-3 col-md-6 mb-4">
		<div class="card border-left-primary shadow h-100 py-2">
			<div class="card-body">
				<div class="row no-gutters align-items-center">
					<div class="col mr-2">
						<div class="text-xs font-weight-bold text-primary text-uppercase mb-1" id="salescontractname"></div>
						<div class="h5 mb-0 font-weight-bold text-gray-800" id="salescontractsum"></div>
					</div>

				</div>
			</div>
		</div>
	</div>

	<!-- Earnings (Monthly) Card Example -->
	<div class="col-xl-3 col-md-6 mb-4">
		<div class="card border-left-success shadow h-100 py-2">
			<div class="card-body">
				<div class="row no-gutters align-items-center">
					<div class="col mr-2">
						<div class="text-xs font-weight-bold text-success text-uppercase mb-1" id="invoicename"></div>
						<div class="h5 mb-0 font-weight-bold text-gray-800" id="invoicesum"></div>
					</div>

				</div>
			</div>
		</div>
	</div>

	<!-- Earnings (Monthly) Card Example -->
	<div class="col-xl-3 col-md-6 mb-4">
		<div class="card border-left-success shadow h-100 py-2">
			<div class="card-body">
				<div class="row no-gutters align-items-center">
					<div class="col mr-2">
						<div class="text-xs font-weight-bold text-success text-uppercase mb-1">客户数量</div>
						<div class="h5 mb-0 font-weight-bold text-gray-800" id="customercount"></div>
					</div>

				</div>
			</div>
		</div>
	</div>

	<!-- Pending Requests Card Example -->
	<div class="col-xl-3 col-md-6 mb-4">
		<div class="card border-left-warning shadow h-100 py-2">
			<div class="card-body">
				<div class="row no-gutters align-items-center">
					<div class="col mr-2">
						<div class="text-xs font-weight-bold text-warning text-uppercase mb-1">供应商数量</div>
						<div class="h5 mb-0 font-weight-bold text-gray-800" id="suppliercount"></div>
					</div>

				</div>
			</div>
		</div>
	</div>
</div>


<div class="wrapper wrapper-content animated fadeInRight" >
	<div class="row">
		<div class="col-sm-6">
			<div class="ibox float-e-margins">
				<div class="ibox-title">
					<h5 id="echarstitleline">销售采购统计</h5>
					<div class="ibox-tools">

						<a  class="dropdown-toggle" data-toggle="dropdown" href="graph_flot.html#">
							按年统计
						</a>
						<ul id="yearsline" class="dropdown-menu dropdown-user">
						</ul>
						<a class="close-link">
							<i class="fa fa-times"></i>
						</a>
					</div>


					<div class="ibox-tools">
						<a class="dropdown-toggle" data-toggle="dropdown" href="graph_flot.html#">
							按月统计
						</a>
						<ul id="monthsline" class="dropdown-menu dropdown-user">
						</ul>
					</div>


				</div>
				<div class="ibox-content">
					<div class="echarts" id="echarts-line-chart"></div>
				</div>
			</div>
		</div>


		<div class="col-sm-6">
			<div class="ibox float-e-margins">
				<div class="ibox-title">
					<h5 id="echarstitlebar">销售采购统计</h5>
					<div class="ibox-tools">

						<a  class="dropdown-toggle" data-toggle="dropdown" href="graph_flot.html#">
							按年统计
						</a>
						<ul id="yearsbar" class="dropdown-menu dropdown-user">


						</ul>

							<a class="close-link">
								<i class="fa fa-times"></i>
							</a>
					</div>


					<div class="ibox-tools">

						<a class="dropdown-toggle" data-toggle="dropdown" href="graph_flot.html#">
							按月统计
						</a>
						<ul id="monthsbar" class="dropdown-menu dropdown-user">

						</ul>


					</div>


				</div>
				<div class="ibox-content">

					<div class="echarts" id="echarts-bar-chart"></div>
				</div>
			</div>
		</div>
	</div>

    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/ajax/libs/layer/layer.min.js}"></script>
		<th:block th:include="include :: echarts-js" />
    <script type="text/javascript">

        $(function () {
            var now = new Date();
            var year = now.getFullYear();
            $("#invoicename").html("销售发票金额"+"("+year+")");
            $("#salescontractname").html("销售金额"+"("+year+")");
            $("#echarstitleline").html("销售采购统计"+"("+year+")");
            $("#echarstitlebar").html("销售采购统计"+"("+year+")");



            /*客户数量*/
            $.ajax({
                url:'home/customersize',
                dataType:'json',
                type:'post',
                success:function(result){
                 $("#customercount").html(result);
                }
            });




            /*供应商数量*/
            $.ajax({
                url:'home/suppliersize',
                dataType:'json',
                type:'post',
                success:function(result){
                    $("#suppliercount").html(result);
                }
            });


            /*发票金额*/
            $.ajax({
                url:'home/invoicemoneybyyear',
                dataType:'json',
                success:function(result){

                    $("#invoicesum").html("￥"+result);

                }
            });




            /*销售金额*/
				$.ajax({
					url:'home/saleMoneyByYear',
					dataType:'json',
					success:function(result){
						$("#salescontractsum").html("￥"+result);
					}
				});




            getmonth();

            getyears();

            echarsinit(year);


        });



        function getmonth(){
            for(var i=1;i<=12;i++){
                $("#monthsbar").append("<li><a href='#' onclick='echarsinitmonth("+i+")'>"+i+"月</a></li>");
                $("#monthsline").append("<li><a href='#' onclick='echarsinitmonth("+i+")'>"+i+"月</a></li>");

            }

		}


		function getyears(){
            var now = new Date();
            var year = now.getFullYear();
            for(var i=0;i<=4;i++){
                $("#yearsbar").append("<li><a href='#' onclick='echarsinityear("+(year-i)+")'>"+(year-i)+"年</a></li>");
                $("#yearsline").append("<li><a href='#' onclick='echarsinityear("+(year-i)+")'>"+(year-i)+"年</a></li>");

            }


		}


		function echarsinit(year){

            var months=new Array();

            for (var i=1;i<=12;i++){
                months[i-1]=i;
            }
            var results="";
            $.ajax({
                url:'home/salesamountBymonth',
                async:false,
                dataType:'json',
                type:'post',
                data:{"newdate":year},
                success:function(result){
                    results=result;

                }
            });


            var arr=new Array();

            for (var i=0;i<results.length;i++){
                arr[i]=results[i];
            }


            var arr1=new Array();
            for (var i=1;i<=12;i++){
                var flag=true;
                for (var k=0;k<arr.length;k++){
                    if(i==arr[k].months){

                        arr1[i-1]=arr[k].datas/10000;
                        flag=false;
                        break;
                    }
                }
                if(flag){
                    arr1[i-1]=0;
                }
            }




            var resultspurchase="";
            $.ajax({
                url:'home/PurchasesamountBymonth',
                async:false,
                dataType:'json',
                type:'post',
                data:{"newdate":year},
                success:function(result){
                    resultspurchase=result;

                }
            });


            var arrpurchase=new Array();

            for (var i=0;i<resultspurchase.length;i++){
                arrpurchase[i]=resultspurchase[i];
            }


            var arr1purchase=new Array();
            for (var i=1;i<=12;i++){
                var flag=true;
                for (var k=0;k<arrpurchase.length;k++){
                    if(i==arrpurchase[k].months){

                        arr1purchase[i-1]=arrpurchase[k].datas/10000;
                        flag=false;
                        break;
                    }
                }
                if(flag){
                    arr1purchase[i-1]=0;
                }
            }





            var lineChart = echarts.init(document.getElementById("echarts-line-chart"));
            var lineoption = {

                tooltip : {
                    trigger: 'axis'
                },
                title : {
                    text: '单位(万)'
                },
                legend: {
                    data:['销售金额','采购金额']
                },
                grid:{
                    x:30,
                    x2:40,
                    y2:24
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        data : months
                    }
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ],
                series : [
                    {
                        name:'销售金额',
                        type:'line',
                        data:arr1,
                        markPoint : {
                            data : [
                                {type : 'max', name: '最大值'},
                                {type : 'min', name: '最小值'}
                            ]
                        },

                        markLine : {
                            data : [
                                {type : 'average', name: '平均值'}
                            ]
                        }
                    },
                    {
                        name:'采购金额',
                        type:'line',
                        data:arr1purchase,
                        markPoint : {
                            data : [
                                {name : '年最高', value : 182.2, xAxis: 7, yAxis: 183, symbolSize:18},
                                {name : '年最低', value : 2.3, xAxis: 11, yAxis: 3}
                            ]
                        },
                        markLine : {
                            data : [
                                {type : 'average', name : '平均值'}
                            ]
                        }
                    }
                ]
            };
            lineChart.setOption(lineoption);
            $(window).resize(lineChart.resize);

            var barChart = echarts.init(document.getElementById("echarts-bar-chart"));
            var baroption = {
                title : {
                    text: '单位(万)'
                },
                tooltip : {
                    trigger: 'axis'
                },
                legend: {
                    data:['销售金额','采购金额']
                },

                grid:{
                    x:30,
                    x2:40,
                    y2:24
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        data :months
                    }
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ],
                series : [
                    {
                        name:'销售金额',
                        type:'bar',
                        data:arr1,
                        markPoint : {
                            data : [
                                {type : 'max', name: '最大值'},
                                {type : 'min', name: '最小值'}
                            ]
                        },
                        markLine : {
                            data : [
                                {type : 'average', name: '平均值'}
                            ]
                        }
                    },
                    {
                        name:'采购金额',
                        type:'bar',
                        data:arr1purchase,
                        markPoint : {
                            data : [
                                {name : '年最高', value : 182.2, xAxis: 7, yAxis: 183, symbolSize:18},
                                {name : '年最低', value : 2.3, xAxis: 11, yAxis: 3}
                            ]
                        },
                        markLine : {
                            data : [
                                {type : 'average', name : '平均值'}
                            ]
                        }
                    }
                ]
            };
            barChart.setOption(baroption);

            window.onresize = barChart.resize;
		}


		function echarsinitmonth(month){




           var firstindex=  $("#echarstitleline").html().indexOf("(")+1;



             var year= $("#echarstitleline").html().substr(firstindex,4);

            $("#echarstitleline").html("销售采购统计("+year+"-"+month+")");
            $("#echarstitlebar").html("销售采购统计("+year+"-"+month+")");

            var day = new Date(year,month,0);   //最后一个参数为0,意为获取2018年10月一共多少天


            var days=new Array();

            for (var i=1;i<=day.getDate();i++){
                days[i-1]=i;
            }
            var results="";
            $.ajax({
                url:'home/salesamountByday',
                async:false,
                dataType:'json',
                type:'post',
                data:{"newyear":year,"newmonth":month},
                success:function(result){
                    results=result;

                }
            });


            var arr=new Array();

            for (var i=0;i<results.length;i++){
                arr[i]=results[i];
            }


            var arr1=new Array();

            for (var i=1;i<=day.getDate();i++){
                var flag=true;

                for (var k=0;k<arr.length;k++){

                    if(i==arr[k].days){

                        arr1[i-1]=arr[k].datas/10000;
                        flag=false;
                        break;
                    }
                }
                if(flag){
                    arr1[i-1]=0;
                }
            }



            var resultspurchase="";
            $.ajax({
                url:'home/PurchasesamountByday',
                async:false,
                dataType:'json',
                type:'post',
                data:{"newyear":year,"newmonth":month},
                success:function(result){
                    resultspurchase=result;

                }
            });




            var arrpurchase=new Array();

            for (var i=0;i<resultspurchase.length;i++){
                arrpurchase[i]=resultspurchase[i];
            }


            var arr1purchase=new Array();

            for (var i=1;i<=day.getDate();i++){
                var flag=true;
                for (var k=0;k<arrpurchase.length;k++){
                    if(i==arrpurchase[k].days){

                        arr1purchase[i-1]=arrpurchase[k].datas/10000;
                        flag=false;
                        break;
                    }
                }
                if(flag){
                    arr1purchase[i-1]=0;
                }
            }





            var lineChart = echarts.init(document.getElementById("echarts-line-chart"));
            var lineoption = {

                tooltip : {
                    trigger: 'axis'
                },
                title : {
                    text: '单位(万)'
                },
                legend: {
                    data:['销售金额','采购金额']
                },
                grid:{
                    x:30,
                    x2:40,
                    y2:24
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        data : days
                    }
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ],
                series : [
                    {
                        name:'销售金额',
                        type:'line',
                        data:arr1,
                        markPoint : {
                            data : [
                                {type : 'max', name: '最大值'},
                                {type : 'min', name: '最小值'}
                            ]
                        },

                        markLine : {
                            data : [
                                {type : 'average', name: '平均值'}
                            ]
                        }
                    },
                    {
                        name:'采购金额',
                        type:'line',
                        data:arr1purchase,
                        markPoint : {
                            data : [
                                {name : '年最高', value : 182.2, xAxis: 7, yAxis: 183, symbolSize:18},
                                {name : '年最低', value : 2.3, xAxis: 11, yAxis: 3}
                            ]
                        },
                        markLine : {
                            data : [
                                {type : 'average', name : '平均值'}
                            ]
                        }
                    }
                ]
            };
            lineChart.setOption(lineoption);
            $(window).resize(lineChart.resize);

            var barChart = echarts.init(document.getElementById("echarts-bar-chart"));
            var baroption = {
                title : {
                    text: '单位(万)'
                },
                tooltip : {
                    trigger: 'axis'
                },
                legend: {
                    data:['销售金额','采购金额']
                },

                grid:{
                    x:30,
                    x2:40,
                    y2:24
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        data :days
                    }
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ],
                series : [
                    {
                        name:'销售金额',
                        type:'bar',
                        data:arr1,
                        markPoint : {
                            data : [
                                {type : 'max', name: '最大值'},
                                {type : 'min', name: '最小值'}
                            ]
                        },
                        markLine : {
                            data : [
                                {type : 'average', name: '平均值'}
                            ]
                        }
                    },
                    {
                        name:'采购金额',
                        type:'bar',
                        data:arr1purchase,
                        markPoint : {
                            data : [
                                {name : '年最高', value : 182.2, xAxis: 7, yAxis: 183, symbolSize:18},
                                {name : '年最低', value : 2.3, xAxis: 11, yAxis: 3}
                            ]
                        },
                        markLine : {
                            data : [
                                {type : 'average', name : '平均值'}
                            ]
                        }
                    }
                ]
            };
            barChart.setOption(baroption);

            window.onresize = barChart.resize;
		}

	    $('#pay-qrcode').click(function(){
	        var html=$(this).html();
	        parent.layer.open({
	            title: false,
	            type: 1,
	            closeBtn:false,
	            shadeClose:true,
	            area: ['600px', 'auto'],
	            content: html
	        });
	    });



        function echarsinityear(year){


            $("#echarstitleline").html("销售采购统计"+"("+year+")");
            $("#echarstitlebar").html("销售采购统计"+"("+year+")");

            var months=new Array();

            for (var i=1;i<=12;i++){
                months[i-1]=i;
            }
            var results="";
            $.ajax({
                url:'home/salesamountBymonth',
                async:false,
                dataType:'json',
                type:'post',
                data:{"newdate":year},
                success:function(result){
                    results=result;
                }
            });


            var arr=new Array();

            for (var i=0;i<results.length;i++){
                arr[i]=results[i];
            }


            var arr1=new Array();
            for (var i=1;i<=12;i++){
                var flag=true;
                for (var k=0;k<arr.length;k++){
                    if(i==arr[k].months){

                        arr1[i-1]=arr[k].datas/10000;
                        flag=false;
                        break;
                    }
                }
                if(flag){
                    arr1[i-1]=0;
                }
            }




            var resultspurchase="";
            $.ajax({
                url:'home/PurchasesamountBymonth',
                async:false,
                dataType:'json',
                type:'post',
                data:{"newdate":year},
                success:function(result){
                    resultspurchase=result;

                }
            });


            var arrpurchase=new Array();

            for (var i=0;i<resultspurchase.length;i++){
                arrpurchase[i]=resultspurchase[i];
            }


            var arr1purchase=new Array();
            for (var i=1;i<=12;i++){
                var flag=true;
                for (var k=0;k<arrpurchase.length;k++){
                    if(i==arrpurchase[k].months){

                        arr1purchase[i-1]=arrpurchase[k].datas/10000;
                        flag=false;
                        break;
                    }
                }
                if(flag){
                    arr1purchase[i-1]=0;
                }
            }





            var lineChart = echarts.init(document.getElementById("echarts-line-chart"));
            var lineoption = {

                tooltip : {
                    trigger: 'axis'
                },
                title : {
                    text: '单位(万)'
                },
                legend: {
                    data:['销售金额','采购金额']
                },
                grid:{
                    x:30,
                    x2:40,
                    y2:24
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        data : months
                    }
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ],
                series : [
                    {
                        name:'销售金额',
                        type:'line',
                        data:arr1,
                        markPoint : {
                            data : [
                                {type : 'max', name: '最大值'},
                                {type : 'min', name: '最小值'}
                            ]
                        },

                        markLine : {
                            data : [
                                {type : 'average', name: '平均值'}
                            ]
                        }
                    },
                    {
                        name:'采购金额',
                        type:'line',
                        data:arr1purchase,
                        markPoint : {
                            data : [
                                {name : '年最高', value : 182.2, xAxis: 7, yAxis: 183, symbolSize:18},
                                {name : '年最低', value : 2.3, xAxis: 11, yAxis: 3}
                            ]
                        },
                        markLine : {
                            data : [
                                {type : 'average', name : '平均值'}
                            ]
                        }
                    }
                ]
            };
            lineChart.setOption(lineoption);
            $(window).resize(lineChart.resize);

            var barChart = echarts.init(document.getElementById("echarts-bar-chart"));
            var baroption = {
                title : {
                    text: '单位(万)'
                },
                tooltip : {
                    trigger: 'axis'
                },
                legend: {
                    data:['销售金额','采购金额']
                },

                grid:{
                    x:30,
                    x2:40,
                    y2:24
                },
                calculable : true,
                xAxis : [
                    {
                        type : 'category',
                        data :months
                    }
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ],
                series : [
                    {
                        name:'销售金额',
                        type:'bar',
                        data:arr1,
                        markPoint : {
                            data : [
                                {type : 'max', name: '最大值'},
                                {type : 'min', name: '最小值'}
                            ]
                        },
                        markLine : {
                            data : [
                                {type : 'average', name: '平均值'}
                            ]
                        }
                    },
                    {
                        name:'采购金额',
                        type:'bar',
                        data:arr1purchase,
                        markPoint : {
                            data : [
                                {name : '年最高', value : 182.2, xAxis: 7, yAxis: 183, symbolSize:18},
                                {name : '年最低', value : 2.3, xAxis: 11, yAxis: 3}
                            ]
                        },
                        markLine : {
                            data : [
                                {type : 'average', name : '平均值'}
                            ]
                        }
                    }
                ]
            };
            barChart.setOption(baroption);

            window.onresize = barChart.resize;
        }
    </script>
</body>
</html>
